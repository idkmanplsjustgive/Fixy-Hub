-- Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Load WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()
local Hub = WindUI:CreateWindow("Lley And Aris Chat GPT Hub", Color3.fromRGB(128, 0, 128))

-- Tabs
local NoclipTab = Hub:CreateTab("Noclip")
local ESPTab = Hub:CreateTab("ESP")
local GameTab = Hub:CreateTab("Game Enhancer")
local RoleTab = Hub:CreateTab("Role Viewer")

-- ===========================
-- Noclip
-- ===========================
local noclipEnabled = false
local noclipConn
NoclipTab:AddToggle("Enable Noclip", false, function(state)
    noclipEnabled = state
    if state then
        noclipConn = RunService.Stepped:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
            end
        end)
    else
        if noclipConn then noclipConn:Disconnect() end
    end
end)

-- ===========================
-- ESP (Humanoid Only)
-- ===========================
local espEnabled = false
local espBoxes = {}

local function createESP(player)
    if espBoxes[player] then return end
    local humanoidRootPart = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "ESPBox"
    billboard.Adornee = humanoidRootPart
    billboard.Size = UDim2.new(0, 100, 0, 50)
    billboard.AlwaysOnTop = true
    billboard.Parent = humanoidRootPart

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextScaled = true
    label.Font = Enum.Font.GothamBold
    label.Text = player.Name
    label.Parent = billboard

    espBoxes[player] = billboard
end

local function removeESP(player)
    if espBoxes[player] then
        espBoxes[player]:Destroy()
        espBoxes[player] = nil
    end
end

ESPTab:AddToggle("ESP Humanoids", false, function(state)
    espEnabled = state
    if state then
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                createESP(player)
            end
        end
    else
        for _, player in pairs(Players:GetPlayers()) do
            removeESP(player)
        end
    end
end)

Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        if espEnabled then createESP(player) end
    end)
end)

Players.PlayerRemoving:Connect(removeESP)

-- ===========================
-- Role Viewer (For Impostors & Crewmates)
-- ===========================
local roleViewEnabled = false
local ROLE_COLORS = {
    Crewmate = Color3.fromRGB(0, 255, 0),
    Imposter = Color3.fromRGB(255, 0, 0),
    Neutral = Color3.fromRGB(255, 165, 0)
}

local function attachRoleTag(player)
    local char = player.Character
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso")
    if not root then return end

    local oldTag = root:FindFirstChild("RoleTag")
    if oldTag then oldTag:Destroy() end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "RoleTag"
    billboard.Parent = root
    billboard.Adornee = root
    billboard.Size = UDim2.new(2, 0, 1, 0)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.GothamBold
    label.TextScaled = true
    label.TextStrokeTransparency = 0.25
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Parent = billboard

    local function updateRoleTag()
        -- You may need to adjust this depending on the exact way the game stores role info.
        if player:FindFirstChild("PublicStates") then
            local roleVal = player.PublicStates:FindFirstChild("Role")
            local subRoleVal = player.PublicStates:FindFirstChild("SubRole")
            local roleText = roleVal and roleVal.Value or ""
            local subText = subRoleVal and subRoleVal.Value or ""
            label.Text = string.format("%s | %s | %s", player.Name, roleText, subText)
            label.TextColor3 = ROLE_COLORS[roleText] or Color3.fromRGB(255, 255, 255)
        end
    end
    updateRoleTag()

    -- Listen for changes in roles
    if player:FindFirstChild("PublicStates") then
        for _, v in pairs(player.PublicStates:GetChildren()) do
            if v:IsA("StringValue") then
                v.Changed:Connect(updateRoleTag)
            end
        end
    end
end

RoleTab:AddToggle("Enable Role Viewer", false, function(state)
    roleViewEnabled = state
    if state then
        for _, player in pairs(Players:GetPlayers()) do
            if player.Character then
                attachRoleTag(player)
            end
            player.CharacterAdded:Connect(function()
                if roleViewEnabled then
                    attachRoleTag(player)
                end
            end)
        end
    else
        for _, player in pairs(Players:GetPlayers()) do
            if player.Character then
                local root = player.Character:FindFirstChild("HumanoidRootPart") or player.Character:FindFirstChild("Torso")
                if root and root:FindFirstChild("RoleTag") then
                    root.RoleTag:Destroy()
                end
            end
        end
    end
end)

-- ===========================
-- Dead Body ESP + Notification
-- ===========================
local deadBodyEnabled = false
local deadBodies = {}

local function createDeadBodyESP(model)
    if deadBodies[model] then return end
    local root = model:FindFirstChild("HumanoidRootPart") or model:FindFirstChild("Torso")
    if not root then return end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "DeadBodyESP"
    billboard.Parent = root
    billboard.Adornee = root
    billboard.Size = UDim2.new(2, 0, 1, 0)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.GothamBold
    label.TextScaled = true
    label.TextStrokeTransparency = 0.25
    label.TextColor3 = Color3.fromHSV(0, 1, 1)
    label.Parent = billboard

    deadBodies[model] = label
    label.Text = "DEAD BODY!"

    -- Notification
    game.StarterGui:SetCore("SendNotification", {
        Title = "Dead Body Detected!",
        Text = "A DeadBody appeared!",
        Duration = 3
    })
end

GameTab:AddToggle("Dead Body ESP", false, function(state)
    deadBodyEnabled = state
end)

Workspace.ChildAdded:Connect(function(child)
    if deadBodyEnabled and child.Name == "DeadBody" then
        create
