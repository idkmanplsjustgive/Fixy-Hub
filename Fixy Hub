-- Load WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()
local Window = WindUI:Window("Fixy Hub", Color3.fromRGB(128, 0, 255)) -- Purple GUI

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer
local Camera = Workspace.CurrentCamera

-- MAIN Tab
local MainTab = Window:Tab("MAIN")

-- =========================
-- Noclip (OP)
-- =========================
local NoclipEnabled = false
MainTab:Toggle("Noclip", false, function(state)
	NoclipEnabled = state
end)

RunService.Stepped:Connect(function()
	if NoclipEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
		for _, part in pairs(LocalPlayer.Character:GetChildren()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end
end)

-- =========================
-- Role ESP & Dead Body ESP
-- =========================
local ESPEnabled = false
local DeadBodyESPEnabled = false

local ROLE_COLORS = {
	Crewmate = Color3.fromRGB(0, 255, 0),
	Imposter = Color3.fromRGB(255, 0, 0),
	Neutral = Color3.fromRGB(255, 165, 0) -- Orange
}

local function createRoleTag(player)
	if not player.Character then return end
	local torso = player.Character:FindFirstChild("UpperTorso") or player.Character:FindFirstChild("Torso")
	if not torso then return end

	local old = torso:FindFirstChild("RoleTag")
	if old then old:Destroy() end

	local billboard = Instance.new("BillboardGui")
	billboard.Name = "RoleTag"
	billboard.Parent = torso
	billboard.Adornee = torso
	billboard.Size = UDim2.new(2,0,1,0)
	billboard.StudsOffset = Vector3.new(0, 2.5, 0)
	billboard.AlwaysOnTop = true
	billboard.MaxDistance = 150

	local roleText = Instance.new("TextLabel")
	roleText.Parent = billboard
	roleText.BackgroundTransparency = 1
	roleText.Size = UDim2.new(1,0,1,0)
	roleText.Font = Enum.Font.GothamBold
	roleText.TextScaled = true
	roleText.TextStrokeTransparency = 0.25
	roleText.TextColor3 = Color3.fromRGB(255,255,255)
	roleText.Text = player.Name .. " | Loading..."

	local function update()
		local ps = player:FindFirstChild("PublicStates")
		if not ps then return end

		local roleVal = ps:FindFirstChild("Role")
		local subRoleVal = ps:FindFirstChild("SubRole")

		local roleName = roleVal and roleVal.Value or "Unknown"
		local subRoleName = subRoleVal and subRoleVal.Value or ""

		local color = ROLE_COLORS[roleName] or Color3.fromRGB(200,200,200)
		roleText.TextColor3 = color
		roleText.Text = string.format("%s | %s | %s", player.Name, roleName, subRoleName)
	end

	if player:FindFirstChild("PublicStates") then
		for _, v in ipairs(player.PublicStates:GetChildren()) do
			if v:IsA("StringValue") then
				v.Changed:Connect(update)
			end
		end
		player.PublicStates.ChildAdded:Connect(function(v)
			if v:IsA("StringValue") then
				v.Changed:Connect(update)
				update()
			end
		end)
	end

	update()
end

local function setupPlayerESP(player)
	player.CharacterAdded:Connect(function(char)
		if ESPEnabled then
			createRoleTag(player)
		end
	end)
	if player.Character and ESPEnabled then
		createRoleTag(player)
	end
end

for _, plr in ipairs(Players:GetPlayers()) do
	setupPlayerESP(plr)
end

Players.PlayerAdded:Connect(setupPlayerESP)

MainTab:Toggle("Role ESP", false, function(state)
	ESPEnabled = state
	if state then
		for _, plr in ipairs(Players:GetPlayers()) do
			createRoleTag(plr)
		end
	else
		for _, plr in ipairs(Players:GetPlayers()) do
			if plr.Character then
				local torso = plr.Character:FindFirstChild("UpperTorso") or plr.Character:FindFirstChild("Torso")
				if torso then
					local old = torso:FindFirstChild("RoleTag")
					if old then old:Destroy() end
				end
			end
		end
	end
end)

-- Dead Body ESP
MainTab:Toggle("Dead Body ESP", false, function(state)
	DeadBodyESPEnabled = state
end)

RunService.RenderStepped:Connect(function()
	if DeadBodyESPEnabled then
		for _, body in pairs(Workspace:FindFirstChild("DeadBody") and Workspace.DeadBody:GetChildren() or {}) do
			if body:IsA("BasePart") and not body:FindFirstChild("ESPTag") then
				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESPTag"
				billboard.Parent = body
				billboard.Adornee = body
				billboard.Size = UDim2.new(2,0,1,0)
				billboard.StudsOffset = Vector3.new(0,2,0)
				billboard.AlwaysOnTop = true

				local label = Instance.new("TextLabel")
				label.Parent = billboard
				label.BackgroundTransparency = 1
				label.Size = UDim2.new(1,0,1,0)
				label.Font = Enum.Font.GothamBold
				label.TextScaled = true
				label.TextStrokeTransparency = 0.25
				label.TextColor3 = Color3.fromRGB(255,0,255)
				label.Text = "DEAD BODY"
			end
		end
	end
end)

-- =========================
-- Game Enhancer
-- =========================
local FullZoomEnabled = false
local MaxVisionEnabled = false
local RemoveFogEnabled = false

MainTab:Toggle("Full Zoom", false, function(state)
	FullZoomEnabled = state
end)

MainTab:Toggle("Max Vision", false, function(state)
	MaxVisionEnabled = state
	if state then
		Camera.FieldOfView = 120
	else
		Camera.FieldOfView = 70
	end
end)

MainTab:Toggle("Remove Fog", false, function(state)
	RemoveFogEnabled = state
	if state then
		Workspace.FogEnd = 100000
		Workspace.FogStart = 0
	else
		Workspace.FogEnd = 1000
		Workspace.FogStart = 0
	end
end)

-- Optional: Full Zoom continuously
RunService.RenderStepped:Connect(function()
	if FullZoomEnabled then
		Camera.FieldOfView = 200
	end
end)

print("Fixy Hub Loaded Successfully!")
